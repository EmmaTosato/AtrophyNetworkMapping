<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 8.1.0 (20230707.2238)
 -->
<!-- Title: DL_Pipeline Pages: 1 -->
<svg width="1295pt" height="1664pt"
 viewBox="0.00 0.00 1295.00 1664.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1660)">
<title>DL_Pipeline</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1660 1291,-1660 1291,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_tuning</title>
<polygon fill="lightyellow" stroke="black" points="297,-1069 297,-1648 621,-1648 621,-1069 297,-1069"/>
<text text-anchor="start" x="304.88" y="-1631.7" font-family="Times,serif" font-weight="bold" font-size="14.00">PHASE 1: HYPERPARAMETER TUNING</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_runs</title>
<polygon fill="lightcyan" stroke="black" points="616,-500.38 616,-934 916,-934 916,-500.38 616,-500.38"/>
<text text-anchor="start" x="623.88" y="-917.7" font-family="Times,serif" font-weight="bold" font-size="14.00">PHASE 2: FINAL RUNS (Multi&#45;Seed)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_testing</title>
<polygon fill="lightpink" stroke="black" points="831,-8 831,-473.5 1052,-473.5 1052,-8 831,-8"/>
<text text-anchor="start" x="838.75" y="-457.2" font-family="Times,serif" font-weight="bold" font-size="14.00">PHASE 3: FINAL TESTING</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_data</title>
<polygon fill="lightgrey" stroke="black" points="629,-1420.25 629,-1548.25 1279,-1548.25 1279,-1420.25 629,-1420.25"/>
<text text-anchor="start" x="892.12" y="-1531.95" font-family="Times,serif" font-weight="bold" font-size="14.00">DATA SOURCES</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_concepts</title>
<polygon fill="lavender" stroke="black" points="8,-492.5 8,-604.75 608,-604.75 608,-492.5 8,-492.5"/>
<text text-anchor="start" x="245.38" y="-588.45" font-family="Times,serif" font-weight="bold" font-size="14.00">KEY CONCEPTS</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_legend</title>
<polygon fill="white" stroke="black" points="767,-1569 767,-1646.25 1141,-1646.25 1141,-1569 767,-1569"/>
<text text-anchor="start" x="920.25" y="-1629.95" font-family="Times,serif" font-weight="bold" font-size="14.00">LEGEND</text>
</g>
<!-- grid -->
<g id="node1" class="node">
<title>grid</title>
<path fill="gold" stroke="black" d="M536.62,-1614.75C536.62,-1614.75 455.38,-1614.75 455.38,-1614.75 449.38,-1614.75 443.38,-1608.75 443.38,-1602.75 443.38,-1602.75 443.38,-1587.25 443.38,-1587.25 443.38,-1581.25 449.38,-1575.25 455.38,-1575.25 455.38,-1575.25 536.62,-1575.25 536.62,-1575.25 542.62,-1575.25 548.62,-1581.25 548.62,-1587.25 548.62,-1587.25 548.62,-1602.75 548.62,-1602.75 548.62,-1608.75 542.62,-1614.75 536.62,-1614.75"/>
<text text-anchor="middle" x="496" y="-1597.45" font-family="Arial" font-size="14.00">Grid Search</text>
<text text-anchor="middle" x="496" y="-1581.7" font-family="Arial" font-size="14.00">(cnn_grid.json)</text>
</g>
<!-- config_loop -->
<g id="node2" class="node">
<title>config_loop</title>
<path fill="#eedd82" stroke="black" d="M601.12,-1515C601.12,-1515 390.88,-1515 390.88,-1515 384.88,-1515 378.88,-1509 378.88,-1503 378.88,-1503 378.88,-1440.25 378.88,-1440.25 378.88,-1434.25 384.88,-1428.25 390.88,-1428.25 390.88,-1428.25 601.12,-1428.25 601.12,-1428.25 607.12,-1428.25 613.12,-1434.25 613.12,-1440.25 613.12,-1440.25 613.12,-1503 613.12,-1503 613.12,-1509 607.12,-1515 601.12,-1515"/>
<text text-anchor="middle" x="496" y="-1497.7" font-family="Arial" font-size="14.00">For each config:</text>
<text text-anchor="middle" x="496" y="-1481.95" font-family="Arial" font-size="14.00">• Model (ResNet/DenseNet/VGG16)</text>
<text text-anchor="middle" x="496" y="-1466.2" font-family="Arial" font-size="14.00">• LR (1e&#45;3, 1e&#45;4, 1e&#45;5)</text>
<text text-anchor="middle" x="496" y="-1450.45" font-family="Arial" font-size="14.00">• Batch size (4, 8, 16)</text>
<text text-anchor="middle" x="496" y="-1434.7" font-family="Arial" font-size="14.00">• Optimizer (Adam, SGD)</text>
</g>
<!-- grid&#45;&gt;config_loop -->
<g id="edge1" class="edge">
<title>grid&#45;&gt;config_loop</title>
<path fill="none" stroke="black" d="M496,-1574.77C496,-1561.59 496,-1543.43 496,-1526.06"/>
<polygon fill="black" stroke="black" points="499.5,-1526.41 496,-1516.41 492.5,-1526.41 499.5,-1526.41"/>
</g>
<!-- cv_tuning -->
<g id="node3" class="node">
<title>cv_tuning</title>
<path fill="lightgreen" stroke="black" d="M601.12,-1376.5C601.12,-1376.5 468.88,-1376.5 468.88,-1376.5 462.88,-1376.5 456.88,-1370.5 456.88,-1364.5 456.88,-1364.5 456.88,-1349 456.88,-1349 456.88,-1343 462.88,-1337 468.88,-1337 468.88,-1337 601.12,-1337 601.12,-1337 607.12,-1337 613.12,-1343 613.12,-1349 613.12,-1349 613.12,-1364.5 613.12,-1364.5 613.12,-1370.5 607.12,-1376.5 601.12,-1376.5"/>
<text text-anchor="middle" x="535" y="-1359.2" font-family="Arial" font-size="14.00">5&#45;Fold Cross&#45;Validation</text>
<text text-anchor="middle" x="535" y="-1343.45" font-family="Arial" font-size="14.00">(105 train patients)</text>
</g>
<!-- config_loop&#45;&gt;cv_tuning -->
<g id="edge2" class="edge">
<title>config_loop&#45;&gt;cv_tuning</title>
<path fill="none" stroke="black" d="M510.74,-1427.95C515.45,-1414.34 520.55,-1399.58 524.85,-1387.13"/>
<polygon fill="black" stroke="black" points="528.44,-1388.46 528.4,-1377.86 521.82,-1386.17 528.44,-1388.46"/>
</g>
<!-- best_fold_tuning -->
<g id="node4" class="node">
<title>best_fold_tuning</title>
<path fill="lightcoral" stroke="black" d="M598,-1285.25C598,-1285.25 492,-1285.25 492,-1285.25 486,-1285.25 480,-1279.25 480,-1273.25 480,-1273.25 480,-1257.75 480,-1257.75 480,-1251.75 486,-1245.75 492,-1245.75 492,-1245.75 598,-1245.75 598,-1245.75 604,-1245.75 610,-1251.75 610,-1257.75 610,-1257.75 610,-1273.25 610,-1273.25 610,-1279.25 604,-1285.25 598,-1285.25"/>
<text text-anchor="middle" x="545" y="-1267.95" font-family="Arial" font-size="14.00">Select Best Fold</text>
<text text-anchor="middle" x="545" y="-1252.2" font-family="Arial" font-size="14.00">(max val accuracy)</text>
</g>
<!-- cv_tuning&#45;&gt;best_fold_tuning -->
<g id="edge3" class="edge">
<title>cv_tuning&#45;&gt;best_fold_tuning</title>
<path fill="none" stroke="black" d="M537.12,-1336.82C538.44,-1325.07 540.16,-1309.71 541.66,-1296.34"/>
<polygon fill="black" stroke="black" points="545.21,-1297.04 542.85,-1286.71 538.26,-1296.26 545.21,-1297.04"/>
</g>
<!-- cv_concept -->
<g id="node21" class="node">
<title>cv_concept</title>
<path fill="lightgreen" stroke="black" d="M182.38,-571.5C182.38,-571.5 27.62,-571.5 27.62,-571.5 21.62,-571.5 15.62,-565.5 15.62,-559.5 15.62,-559.5 15.62,-512.5 15.62,-512.5 15.62,-506.5 21.62,-500.5 27.62,-500.5 27.62,-500.5 182.38,-500.5 182.38,-500.5 188.38,-500.5 194.38,-506.5 194.38,-512.5 194.38,-512.5 194.38,-559.5 194.38,-559.5 194.38,-565.5 188.38,-571.5 182.38,-571.5"/>
<text text-anchor="middle" x="105" y="-554.2" font-family="Arial" font-size="14.00">Cross&#45;Validation</text>
<text text-anchor="middle" x="105" y="-538.45" font-family="Arial" font-size="14.00">• 5&#45;fold stratified</text>
<text text-anchor="middle" x="105" y="-522.7" font-family="Arial" font-size="14.00">• ~84 train, ~21 val per fold</text>
<text text-anchor="middle" x="105" y="-506.95" font-family="Arial" font-size="14.00">• Best fold by val accuracy</text>
</g>
<!-- cv_tuning&#45;&gt;cv_concept -->
<g id="edge27" class="edge">
<title>cv_tuning&#45;&gt;cv_concept</title>
<path fill="none" stroke="grey" stroke-dasharray="1,5" d="M456.53,-1351.31C400.5,-1343.38 335,-1322.2 335,-1266.5 335,-1266.5 335,-1266.5 335,-650.5 335,-588.41 258.38,-632.83 203,-604.75 188.02,-597.15 172.68,-587.56 158.72,-578"/>
<polygon fill="grey" stroke="grey" points="160.96,-574.6 150.76,-571.74 156.95,-580.34 160.96,-574.6"/>
</g>
<!-- test_tuning -->
<g id="node5" class="node">
<title>test_tuning</title>
<path fill="lightcyan" stroke="black" d="M597,-1208.75C597,-1208.75 509,-1208.75 509,-1208.75 503,-1208.75 497,-1202.75 497,-1196.75 497,-1196.75 497,-1181.25 497,-1181.25 497,-1175.25 503,-1169.25 509,-1169.25 509,-1169.25 597,-1169.25 597,-1169.25 603,-1169.25 609,-1175.25 609,-1181.25 609,-1181.25 609,-1196.75 609,-1196.75 609,-1202.75 603,-1208.75 597,-1208.75"/>
<text text-anchor="middle" x="553" y="-1191.45" font-family="Arial" font-size="14.00">Test on Test Set</text>
<text text-anchor="middle" x="553" y="-1175.7" font-family="Arial" font-size="14.00">(27 patients)</text>
</g>
<!-- best_fold_tuning&#45;&gt;test_tuning -->
<g id="edge4" class="edge">
<title>best_fold_tuning&#45;&gt;test_tuning</title>
<path fill="none" stroke="black" d="M547.06,-1245.31C547.89,-1237.58 548.87,-1228.48 549.79,-1219.91"/>
<polygon fill="black" stroke="black" points="553.36,-1220.44 550.95,-1210.12 546.4,-1219.69 553.36,-1220.44"/>
</g>
<!-- save_tuning -->
<g id="node6" class="node">
<title>save_tuning</title>
<path fill="plum" stroke="black" d="M601.12,-1132.25C601.12,-1132.25 456.88,-1132.25 456.88,-1132.25 450.88,-1132.25 444.88,-1126.25 444.88,-1120.25 444.88,-1120.25 444.88,-1089 444.88,-1089 444.88,-1083 450.88,-1077 456.88,-1077 456.88,-1077 601.12,-1077 601.12,-1077 607.12,-1077 613.12,-1083 613.12,-1089 613.12,-1089 613.12,-1120.25 613.12,-1120.25 613.12,-1126.25 607.12,-1132.25 601.12,-1132.25"/>
<text text-anchor="middle" x="529" y="-1114.95" font-family="Arial" font-size="14.00">Save:</text>
<text text-anchor="middle" x="529" y="-1099.2" font-family="Arial" font-size="14.00">• grid_results.csv</text>
<text text-anchor="middle" x="529" y="-1083.45" font-family="Arial" font-size="14.00">• best_model_fold{1&#45;5}.pt</text>
</g>
<!-- test_tuning&#45;&gt;save_tuning -->
<g id="edge5" class="edge">
<title>test_tuning&#45;&gt;save_tuning</title>
<path fill="none" stroke="black" d="M547.43,-1168.89C545.18,-1161.17 542.51,-1151.98 539.9,-1143.03"/>
<polygon fill="black" stroke="black" points="543.06,-1142.36 536.9,-1133.74 536.34,-1144.32 543.06,-1142.36"/>
</g>
<!-- select_best -->
<g id="node7" class="node">
<title>select_best</title>
<path fill="orange" stroke="black" d="M617.53,-1036.47C617.53,-1036.47 511.97,-1004.03 511.97,-1004.03 506.24,-1002.26 506.24,-998.74 511.97,-996.97 511.97,-996.97 617.53,-964.53 617.53,-964.53 623.26,-962.76 634.74,-962.76 640.47,-964.53 640.47,-964.53 746.03,-996.97 746.03,-996.97 751.76,-998.74 751.76,-1002.26 746.03,-1004.03 746.03,-1004.03 640.47,-1036.47 640.47,-1036.47 634.74,-1038.24 623.26,-1038.24 617.53,-1036.47"/>
<text text-anchor="middle" x="629" y="-1002.95" font-family="Arial" font-size="14.00">Select Top Configs</text>
<text text-anchor="middle" x="629" y="-987.2" font-family="Arial" font-size="14.00">(by test accuracy)</text>
</g>
<!-- save_tuning&#45;&gt;select_best -->
<g id="edge6" class="edge">
<title>save_tuning&#45;&gt;select_best</title>
<path fill="none" stroke="black" d="M555.54,-1076.53C566.84,-1064.98 580.22,-1051.31 592.45,-1038.83"/>
<polygon fill="black" stroke="black" points="594.38,-1041.84 598.88,-1032.24 589.38,-1036.94 594.38,-1041.84"/>
</g>
<!-- best_hyperparams -->
<g id="node8" class="node">
<title>best_hyperparams</title>
<path fill="gold" stroke="black" d="M792.75,-900.75C792.75,-900.75 637.25,-900.75 637.25,-900.75 631.25,-900.75 625.25,-894.75 625.25,-888.75 625.25,-888.75 625.25,-873.25 625.25,-873.25 625.25,-867.25 631.25,-861.25 637.25,-861.25 637.25,-861.25 792.75,-861.25 792.75,-861.25 798.75,-861.25 804.75,-867.25 804.75,-873.25 804.75,-873.25 804.75,-888.75 804.75,-888.75 804.75,-894.75 798.75,-900.75 792.75,-900.75"/>
<text text-anchor="middle" x="715" y="-883.45" font-family="Arial" font-size="14.00">Use Best Hyperparameters</text>
<text text-anchor="middle" x="715" y="-867.7" font-family="Arial" font-size="14.00">from Tuning</text>
</g>
<!-- select_best&#45;&gt;best_hyperparams -->
<g id="edge11" class="edge">
<title>select_best&#45;&gt;best_hyperparams</title>
<path fill="none" stroke="black" d="M652.27,-967.7C665.57,-949.53 682.09,-926.96 694.84,-909.55"/>
<polygon fill="black" stroke="black" points="698.04,-912.1 701.12,-901.96 692.39,-907.97 698.04,-912.1"/>
</g>
<!-- seed_loop -->
<g id="node9" class="node">
<title>seed_loop</title>
<path fill="#eedd82" stroke="black" d="M800.25,-824.25C800.25,-824.25 635.75,-824.25 635.75,-824.25 629.75,-824.25 623.75,-818.25 623.75,-812.25 623.75,-812.25 623.75,-796.75 623.75,-796.75 623.75,-790.75 629.75,-784.75 635.75,-784.75 635.75,-784.75 800.25,-784.75 800.25,-784.75 806.25,-784.75 812.25,-790.75 812.25,-796.75 812.25,-796.75 812.25,-812.25 812.25,-812.25 812.25,-818.25 806.25,-824.25 800.25,-824.25"/>
<text text-anchor="middle" x="718" y="-806.95" font-family="Arial" font-size="14.00">For each seed:</text>
<text text-anchor="middle" x="718" y="-791.2" font-family="Arial" font-size="14.00">42, 123, 2023, 31415, 98765</text>
</g>
<!-- best_hyperparams&#45;&gt;seed_loop -->
<g id="edge7" class="edge">
<title>best_hyperparams&#45;&gt;seed_loop</title>
<path fill="none" stroke="black" d="M715.77,-860.81C716.08,-853.08 716.45,-843.98 716.8,-835.41"/>
<polygon fill="black" stroke="black" points="720.32,-835.75 717.23,-825.62 713.33,-835.47 720.32,-835.75"/>
</g>
<!-- cv_runs -->
<g id="node10" class="node">
<title>cv_runs</title>
<path fill="lightgreen" stroke="black" d="M896.12,-747.75C896.12,-747.75 763.88,-747.75 763.88,-747.75 757.88,-747.75 751.88,-741.75 751.88,-735.75 751.88,-735.75 751.88,-720.25 751.88,-720.25 751.88,-714.25 757.88,-708.25 763.88,-708.25 763.88,-708.25 896.12,-708.25 896.12,-708.25 902.12,-708.25 908.12,-714.25 908.12,-720.25 908.12,-720.25 908.12,-735.75 908.12,-735.75 908.12,-741.75 902.12,-747.75 896.12,-747.75"/>
<text text-anchor="middle" x="830" y="-730.45" font-family="Arial" font-size="14.00">5&#45;Fold Cross&#45;Validation</text>
<text text-anchor="middle" x="830" y="-714.7" font-family="Arial" font-size="14.00">(105 train patients)</text>
</g>
<!-- seed_loop&#45;&gt;cv_runs -->
<g id="edge8" class="edge">
<title>seed_loop&#45;&gt;cv_runs</title>
<path fill="none" stroke="black" d="M746.84,-784.31C760.69,-775.1 777.46,-763.95 792.31,-754.07"/>
<polygon fill="black" stroke="black" points="793.87,-756.57 800.25,-748.12 789.99,-750.74 793.87,-756.57"/>
</g>
<!-- seed_concept -->
<g id="node22" class="node">
<title>seed_concept</title>
<path fill="lightcoral" stroke="black" d="M385.75,-571.5C385.75,-571.5 224.25,-571.5 224.25,-571.5 218.25,-571.5 212.25,-565.5 212.25,-559.5 212.25,-559.5 212.25,-512.5 212.25,-512.5 212.25,-506.5 218.25,-500.5 224.25,-500.5 224.25,-500.5 385.75,-500.5 385.75,-500.5 391.75,-500.5 397.75,-506.5 397.75,-512.5 397.75,-512.5 397.75,-559.5 397.75,-559.5 397.75,-565.5 391.75,-571.5 385.75,-571.5"/>
<text text-anchor="middle" x="305" y="-554.2" font-family="Arial" font-size="14.00">Seed Management</text>
<text text-anchor="middle" x="305" y="-538.45" font-family="Arial" font-size="14.00">• KFold seed: Controls splits</text>
<text text-anchor="middle" x="305" y="-522.7" font-family="Arial" font-size="14.00">• PyTorch seed: Controls init</text>
<text text-anchor="middle" x="305" y="-506.95" font-family="Arial" font-size="14.00">• Multi&#45;seed: Robustness</text>
</g>
<!-- seed_loop&#45;&gt;seed_concept -->
<g id="edge28" class="edge">
<title>seed_loop&#45;&gt;seed_concept</title>
<path fill="none" stroke="grey" stroke-dasharray="1,5" d="M687.86,-784.49C632.19,-749.31 509.54,-671.56 407,-604.75 393.83,-596.17 379.76,-586.89 366.41,-578.04"/>
<polygon fill="grey" stroke="grey" points="368.56,-574.61 358.3,-571.99 364.69,-580.44 368.56,-574.61"/>
</g>
<!-- best_fold_runs -->
<g id="node11" class="node">
<title>best_fold_runs</title>
<path fill="lightcoral" stroke="black" d="M880,-671.25C880,-671.25 774,-671.25 774,-671.25 768,-671.25 762,-665.25 762,-659.25 762,-659.25 762,-643.75 762,-643.75 762,-637.75 768,-631.75 774,-631.75 774,-631.75 880,-631.75 880,-631.75 886,-631.75 892,-637.75 892,-643.75 892,-643.75 892,-659.25 892,-659.25 892,-665.25 886,-671.25 880,-671.25"/>
<text text-anchor="middle" x="827" y="-653.95" font-family="Arial" font-size="14.00">Select Best Fold</text>
<text text-anchor="middle" x="827" y="-638.2" font-family="Arial" font-size="14.00">(max val accuracy)</text>
</g>
<!-- cv_runs&#45;&gt;best_fold_runs -->
<g id="edge9" class="edge">
<title>cv_runs&#45;&gt;best_fold_runs</title>
<path fill="none" stroke="black" d="M829.23,-707.81C828.92,-700.08 828.55,-690.98 828.2,-682.41"/>
<polygon fill="black" stroke="black" points="831.67,-682.47 827.77,-672.62 824.68,-682.75 831.67,-682.47"/>
</g>
<!-- save_runs -->
<g id="node12" class="node">
<title>save_runs</title>
<path fill="plum" stroke="black" d="M895.75,-563.62C895.75,-563.62 758.25,-563.62 758.25,-563.62 752.25,-563.62 746.25,-557.62 746.25,-551.62 746.25,-551.62 746.25,-520.38 746.25,-520.38 746.25,-514.38 752.25,-508.38 758.25,-508.38 758.25,-508.38 895.75,-508.38 895.75,-508.38 901.75,-508.38 907.75,-514.38 907.75,-520.38 907.75,-520.38 907.75,-551.62 907.75,-551.62 907.75,-557.62 901.75,-563.62 895.75,-563.62"/>
<text text-anchor="middle" x="827" y="-546.33" font-family="Arial" font-size="14.00">Save:</text>
<text text-anchor="middle" x="827" y="-530.58" font-family="Arial" font-size="14.00">• all_training_results.csv</text>
<text text-anchor="middle" x="827" y="-514.83" font-family="Arial" font-size="14.00">• best_model_fold{N}.pt</text>
</g>
<!-- best_fold_runs&#45;&gt;save_runs -->
<g id="edge10" class="edge">
<title>best_fold_runs&#45;&gt;save_runs</title>
<path fill="none" stroke="black" d="M827,-631.5C827,-615.99 827,-593.6 827,-574.5"/>
<polygon fill="black" stroke="black" points="830.5,-574.72 827,-564.72 823.5,-574.72 830.5,-574.72"/>
</g>
<!-- early_stop -->
<g id="node23" class="node">
<title>early_stop</title>
<path fill="lightyellow" stroke="black" d="M588.38,-571.5C588.38,-571.5 427.62,-571.5 427.62,-571.5 421.62,-571.5 415.62,-565.5 415.62,-559.5 415.62,-559.5 415.62,-512.5 415.62,-512.5 415.62,-506.5 421.62,-500.5 427.62,-500.5 427.62,-500.5 588.38,-500.5 588.38,-500.5 594.38,-500.5 600.38,-506.5 600.38,-512.5 600.38,-512.5 600.38,-559.5 600.38,-559.5 600.38,-565.5 594.38,-571.5 588.38,-571.5"/>
<text text-anchor="middle" x="508" y="-554.2" font-family="Arial" font-size="14.00">Early Stopping</text>
<text text-anchor="middle" x="508" y="-538.45" font-family="Arial" font-size="14.00">• Primary: max val accuracy</text>
<text text-anchor="middle" x="508" y="-522.7" font-family="Arial" font-size="14.00">• Tiebreaker: min val loss</text>
<text text-anchor="middle" x="508" y="-506.95" font-family="Arial" font-size="14.00">• Saves best epoch</text>
</g>
<!-- best_fold_runs&#45;&gt;early_stop -->
<g id="edge29" class="edge">
<title>best_fold_runs&#45;&gt;early_stop</title>
<path fill="none" stroke="grey" stroke-dasharray="1,5" d="M761.64,-642.96C718.04,-636.4 660.11,-624.72 612,-604.75 595.03,-597.7 577.83,-587.84 562.43,-577.81"/>
<polygon fill="grey" stroke="grey" points="564.85,-574.55 554.59,-571.9 560.96,-580.37 564.85,-574.55"/>
</g>
<!-- load_results -->
<g id="node13" class="node">
<title>load_results</title>
<path fill="gold" stroke="black" d="M979.25,-440.25C979.25,-440.25 850.75,-440.25 850.75,-440.25 844.75,-440.25 838.75,-434.25 838.75,-428.25 838.75,-428.25 838.75,-412.75 838.75,-412.75 838.75,-406.75 844.75,-400.75 850.75,-400.75 850.75,-400.75 979.25,-400.75 979.25,-400.75 985.25,-400.75 991.25,-406.75 991.25,-412.75 991.25,-412.75 991.25,-428.25 991.25,-428.25 991.25,-434.25 985.25,-440.25 979.25,-440.25"/>
<text text-anchor="middle" x="915" y="-422.95" font-family="Arial" font-size="14.00">Load:</text>
<text text-anchor="middle" x="915" y="-407.2" font-family="Arial" font-size="14.00">all_training_results.csv</text>
</g>
<!-- save_runs&#45;&gt;load_results -->
<g id="edge16" class="edge">
<title>save_runs&#45;&gt;load_results</title>
<path fill="none" stroke="black" d="M847.85,-508.1C861.66,-490.3 879.71,-467.02 893.62,-449.08"/>
<polygon fill="black" stroke="black" points="896.71,-451.8 900.08,-441.75 891.18,-447.51 896.71,-451.8"/>
</g>
<!-- test_loop -->
<g id="node14" class="node">
<title>test_loop</title>
<path fill="lightcyan" stroke="black" d="M1032.12,-363.75C1032.12,-363.75 863.88,-363.75 863.88,-363.75 857.88,-363.75 851.88,-357.75 851.88,-351.75 851.88,-351.75 851.88,-320.5 851.88,-320.5 851.88,-314.5 857.88,-308.5 863.88,-308.5 863.88,-308.5 1032.12,-308.5 1032.12,-308.5 1038.12,-308.5 1044.12,-314.5 1044.12,-320.5 1044.12,-320.5 1044.12,-351.75 1044.12,-351.75 1044.12,-357.75 1038.12,-363.75 1032.12,-363.75"/>
<text text-anchor="middle" x="948" y="-346.45" font-family="Arial" font-size="14.00">For each run:</text>
<text text-anchor="middle" x="948" y="-330.7" font-family="Arial" font-size="14.00">• Load best_model_fold{N}.pt</text>
<text text-anchor="middle" x="948" y="-314.95" font-family="Arial" font-size="14.00">• Test on 27 patients</text>
</g>
<!-- load_results&#45;&gt;test_loop -->
<g id="edge12" class="edge">
<title>load_results&#45;&gt;test_loop</title>
<path fill="none" stroke="black" d="M922.65,-400.39C925.78,-392.59 929.51,-383.28 933.13,-374.24"/>
<polygon fill="black" stroke="black" points="936.67,-375.82 937.14,-365.24 930.17,-373.22 936.67,-375.82"/>
</g>
<!-- metrics -->
<g id="node15" class="node">
<title>metrics</title>
<path fill="lightgreen" stroke="black" d="M1010.38,-271.5C1010.38,-271.5 885.62,-271.5 885.62,-271.5 879.62,-271.5 873.62,-265.5 873.62,-259.5 873.62,-259.5 873.62,-212.5 873.62,-212.5 873.62,-206.5 879.62,-200.5 885.62,-200.5 885.62,-200.5 1010.38,-200.5 1010.38,-200.5 1016.38,-200.5 1022.38,-206.5 1022.38,-212.5 1022.38,-212.5 1022.38,-259.5 1022.38,-259.5 1022.38,-265.5 1016.38,-271.5 1010.38,-271.5"/>
<text text-anchor="middle" x="948" y="-254.2" font-family="Arial" font-size="14.00">Compute Metrics:</text>
<text text-anchor="middle" x="948" y="-238.45" font-family="Arial" font-size="14.00">• Accuracy</text>
<text text-anchor="middle" x="948" y="-222.7" font-family="Arial" font-size="14.00">• Precision, Recall, F1</text>
<text text-anchor="middle" x="948" y="-206.95" font-family="Arial" font-size="14.00">• Confusion Matrix</text>
</g>
<!-- test_loop&#45;&gt;metrics -->
<g id="edge13" class="edge">
<title>test_loop&#45;&gt;metrics</title>
<path fill="none" stroke="black" d="M948,-308.05C948,-300.15 948,-291.3 948,-282.59"/>
<polygon fill="black" stroke="black" points="951.5,-282.72 948,-272.72 944.5,-282.72 951.5,-282.72"/>
</g>
<!-- save_test -->
<g id="node16" class="node">
<title>save_test</title>
<path fill="plum" stroke="black" d="M1014.5,-163.5C1014.5,-163.5 881.5,-163.5 881.5,-163.5 875.5,-163.5 869.5,-157.5 869.5,-151.5 869.5,-151.5 869.5,-120.25 869.5,-120.25 869.5,-114.25 875.5,-108.25 881.5,-108.25 881.5,-108.25 1014.5,-108.25 1014.5,-108.25 1020.5,-108.25 1026.5,-114.25 1026.5,-120.25 1026.5,-120.25 1026.5,-151.5 1026.5,-151.5 1026.5,-157.5 1020.5,-163.5 1014.5,-163.5"/>
<text text-anchor="middle" x="948" y="-146.2" font-family="Arial" font-size="14.00">Save:</text>
<text text-anchor="middle" x="948" y="-130.45" font-family="Arial" font-size="14.00">• all_testing_results.csv</text>
<text text-anchor="middle" x="948" y="-114.7" font-family="Arial" font-size="14.00">• Confusion matrices</text>
</g>
<!-- metrics&#45;&gt;save_test -->
<g id="edge14" class="edge">
<title>metrics&#45;&gt;save_test</title>
<path fill="none" stroke="black" d="M948,-200.13C948,-191.95 948,-183.19 948,-174.88"/>
<polygon fill="black" stroke="black" points="951.5,-174.92 948,-164.92 944.5,-174.92 951.5,-174.92"/>
</g>
<!-- analysis -->
<g id="node17" class="node">
<title>analysis</title>
<path fill="lightcoral" stroke="black" d="M1025,-71.25C1025,-71.25 871,-71.25 871,-71.25 865,-71.25 859,-65.25 859,-59.25 859,-59.25 859,-28 859,-28 859,-22 865,-16 871,-16 871,-16 1025,-16 1025,-16 1031,-16 1037,-22 1037,-28 1037,-28 1037,-59.25 1037,-59.25 1037,-65.25 1031,-71.25 1025,-71.25"/>
<text text-anchor="middle" x="948" y="-53.95" font-family="Arial" font-size="14.00">Analyze:</text>
<text text-anchor="middle" x="948" y="-38.2" font-family="Arial" font-size="14.00">• Mean ± Std across seeds</text>
<text text-anchor="middle" x="948" y="-22.45" font-family="Arial" font-size="14.00">• Robustness evaluation</text>
</g>
<!-- save_test&#45;&gt;analysis -->
<g id="edge15" class="edge">
<title>save_test&#45;&gt;analysis</title>
<path fill="none" stroke="black" d="M948,-107.8C948,-99.85 948,-91.02 948,-82.53"/>
<polygon fill="black" stroke="black" points="951.5,-82.68 948,-72.68 944.5,-82.68 951.5,-82.68"/>
</g>
<!-- splits -->
<g id="node18" class="node">
<title>splits</title>
<path fill="wheat" stroke="black" d="M1035,-1515C1035,-1515 893,-1515 893,-1515 887,-1515 881,-1509 881,-1503 881,-1503 881,-1440.25 881,-1440.25 881,-1434.25 887,-1428.25 893,-1428.25 893,-1428.25 1035,-1428.25 1035,-1428.25 1041,-1428.25 1047,-1434.25 1047,-1440.25 1047,-1440.25 1047,-1503 1047,-1503 1047,-1509 1041,-1515 1035,-1515"/>
<text text-anchor="middle" x="964" y="-1497.7" font-family="Arial" font-size="14.00">Split CSVs</text>
<text text-anchor="middle" x="964" y="-1481.95" font-family="Arial" font-size="14.00">(assets/split_cnn/)</text>
<text text-anchor="middle" x="964" y="-1466.2" font-family="Arial" font-size="14.00">• ADNI_PSP_splitted.csv</text>
<text text-anchor="middle" x="964" y="-1450.45" font-family="Arial" font-size="14.00">• ADNI_CBS_splitted.csv</text>
<text text-anchor="middle" x="964" y="-1434.7" font-family="Arial" font-size="14.00">• PSP_CBS_splitted.csv</text>
</g>
<!-- splits&#45;&gt;cv_tuning -->
<g id="edge17" class="edge">
<title>splits&#45;&gt;cv_tuning</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M892.12,-1427.81C885.46,-1424.91 878.7,-1422.32 872,-1420.25 828.9,-1406.93 815.54,-1417.38 771,-1410.25 720.93,-1402.23 665.55,-1390.09 621.04,-1379.5"/>
<polygon fill="black" stroke="black" points="622.09,-1375.91 611.55,-1376.99 620.46,-1382.72 622.09,-1375.91"/>
<text text-anchor="middle" x="798" y="-1396.95" font-family="Arial" font-size="14.00">train split</text>
</g>
<!-- splits&#45;&gt;test_tuning -->
<g id="edge19" class="edge">
<title>splits&#45;&gt;test_tuning</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M921.49,-1427.89C892.79,-1400.23 853.29,-1364.4 815,-1337 745.33,-1287.13 657.18,-1240.74 602.97,-1213.89"/>
<polygon fill="black" stroke="black" points="604.77,-1210.38 594.25,-1209.1 601.68,-1216.66 604.77,-1210.38"/>
<text text-anchor="middle" x="810.75" y="-1305.7" font-family="Arial" font-size="14.00">test split</text>
</g>
<!-- splits&#45;&gt;cv_runs -->
<g id="edge18" class="edge">
<title>splits&#45;&gt;cv_runs</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M943.58,-1427.95C935.46,-1407.24 928,-1381.71 928,-1357.75 928,-1357.75 928,-1357.75 928,-803.5 928,-781.55 912.23,-765.22 893.34,-753.54"/>
<polygon fill="black" stroke="black" points="895.3,-750.06 884.87,-748.17 891.85,-756.15 895.3,-750.06"/>
<text text-anchor="middle" x="955" y="-1099.2" font-family="Arial" font-size="14.00">train split</text>
</g>
<!-- splits&#45;&gt;test_loop -->
<g id="edge20" class="edge">
<title>splits&#45;&gt;test_loop</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M995.99,-1427.9C1008.09,-1407.7 1019,-1382.6 1019,-1357.75 1019,-1357.75 1019,-1357.75 1019,-419.5 1019,-401.03 1008.64,-384.65 995.83,-371.46"/>
<polygon fill="black" stroke="black" points="998.72,-369.43 989.06,-365.07 993.89,-374.5 998.72,-369.43"/>
<text text-anchor="middle" x="1043.75" y="-875.58" font-family="Arial" font-size="14.00">test split</text>
</g>
<!-- data_aug -->
<g id="node19" class="node">
<title>data_aug</title>
<path fill="lightgreen" stroke="black" d="M851,-1507.12C851,-1507.12 649,-1507.12 649,-1507.12 643,-1507.12 637,-1501.12 637,-1495.12 637,-1495.12 637,-1448.12 637,-1448.12 637,-1442.12 643,-1436.12 649,-1436.12 649,-1436.12 851,-1436.12 851,-1436.12 857,-1436.12 863,-1442.12 863,-1448.12 863,-1448.12 863,-1495.12 863,-1495.12 863,-1501.12 857,-1507.12 851,-1507.12"/>
<text text-anchor="middle" x="750" y="-1489.83" font-family="Arial" font-size="14.00">Augmented Data</text>
<text text-anchor="middle" x="750" y="-1474.08" font-family="Arial" font-size="14.00">(FCmaps_augmented_processed/)</text>
<text text-anchor="middle" x="750" y="-1458.33" font-family="Arial" font-size="14.00">50× HCP bootstrap</text>
<text text-anchor="middle" x="750" y="-1442.58" font-family="Arial" font-size="14.00">USED ONLY IN TRAINING</text>
</g>
<!-- data_aug&#45;&gt;cv_tuning -->
<g id="edge21" class="edge">
<title>data_aug&#45;&gt;cv_tuning</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M672.05,-1435.73C655.13,-1427.7 637.46,-1418.95 621.25,-1410.25 605.41,-1401.75 588.42,-1391.63 573.75,-1382.56"/>
<polygon fill="black" stroke="black" points="575.81,-1379.1 565.47,-1376.78 572.11,-1385.04 575.81,-1379.1"/>
<text text-anchor="middle" x="646.88" y="-1396.95" font-family="Arial" font-size="14.00">train fold</text>
</g>
<!-- data_aug&#45;&gt;cv_runs -->
<g id="edge22" class="edge">
<title>data_aug&#45;&gt;cv_runs</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M773.85,-1435.85C778.71,-1427.71 783.42,-1418.88 787,-1410.25 791.82,-1398.62 840,-1202.59 840,-1190 840,-1190 840,-1190 840,-803.5 840,-788.72 838.04,-772.43 835.86,-758.86"/>
<polygon fill="black" stroke="black" points="839.17,-758.46 834.01,-749.2 832.27,-759.65 839.17,-758.46"/>
<text text-anchor="middle" x="865.88" y="-1099.2" font-family="Arial" font-size="14.00">train fold</text>
</g>
<!-- data_orig -->
<g id="node20" class="node">
<title>data_orig</title>
<path fill="lightblue" stroke="black" d="M1258.5,-1499.25C1258.5,-1499.25 1077.5,-1499.25 1077.5,-1499.25 1071.5,-1499.25 1065.5,-1493.25 1065.5,-1487.25 1065.5,-1487.25 1065.5,-1456 1065.5,-1456 1065.5,-1450 1071.5,-1444 1077.5,-1444 1077.5,-1444 1258.5,-1444 1258.5,-1444 1264.5,-1444 1270.5,-1450 1270.5,-1456 1270.5,-1456 1270.5,-1487.25 1270.5,-1487.25 1270.5,-1493.25 1264.5,-1499.25 1258.5,-1499.25"/>
<text text-anchor="middle" x="1168" y="-1481.95" font-family="Arial" font-size="14.00">Original Data</text>
<text text-anchor="middle" x="1168" y="-1466.2" font-family="Arial" font-size="14.00">(FCmaps_processed/)</text>
<text text-anchor="middle" x="1168" y="-1450.45" font-family="Arial" font-size="14.00">USED IN VALIDATION &amp; TEST</text>
</g>
<!-- data_orig&#45;&gt;cv_tuning -->
<g id="edge23" class="edge">
<title>data_orig&#45;&gt;cv_tuning</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1116.52,-1443.53C1097.91,-1434.8 1076.44,-1425.93 1056,-1420.25 1015.45,-1408.98 761.92,-1381.41 624.05,-1366.95"/>
<polygon fill="black" stroke="black" points="624.83,-1363.4 614.52,-1365.84 624.1,-1370.37 624.83,-1363.4"/>
<text text-anchor="middle" x="1012.38" y="-1396.95" font-family="Arial" font-size="14.00">val fold</text>
</g>
<!-- data_orig&#45;&gt;test_tuning -->
<g id="edge25" class="edge">
<title>data_orig&#45;&gt;test_tuning</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1123.72,-1443.58C1109.86,-1434 1095.05,-1422.52 1083,-1410.25 1055.39,-1382.12 1064.05,-1361.28 1033,-1337 908.58,-1239.74 719.8,-1206.51 620.11,-1195.4"/>
<polygon fill="black" stroke="black" points="620.6,-1191.83 610.29,-1194.25 619.86,-1198.79 620.6,-1191.83"/>
</g>
<!-- data_orig&#45;&gt;cv_runs -->
<g id="edge24" class="edge">
<title>data_orig&#45;&gt;cv_runs</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1139.12,-1443.86C1119.46,-1422.63 1097,-1391.09 1097,-1357.75 1097,-1357.75 1097,-1357.75 1097,-942 1097,-832.24 1021.8,-815.59 924,-765.75 914.63,-760.98 904.49,-756.42 894.46,-752.25"/>
<polygon fill="black" stroke="black" points="896.07,-748.72 885.49,-748.2 893.44,-755.2 896.07,-748.72"/>
<text text-anchor="middle" x="1118.38" y="-1099.2" font-family="Arial" font-size="14.00">val fold</text>
</g>
<!-- data_orig&#45;&gt;test_loop -->
<g id="edge26" class="edge">
<title>data_orig&#45;&gt;test_loop</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1168,-1443.71C1168,-1420.84 1168,-1387.14 1168,-1357.75 1168,-1357.75 1168,-1357.75 1168,-419.5 1168,-392.91 1110.93,-372.04 1054.93,-357.96"/>
<polygon fill="black" stroke="black" points="1056.04,-354.38 1045.5,-355.41 1054.38,-361.18 1056.04,-354.38"/>
</g>
<!-- leg_process -->
<g id="node24" class="node">
<title>leg_process</title>
<path fill="lightblue" stroke="black" d="M1121.38,-1613C1121.38,-1613 1080.62,-1613 1080.62,-1613 1074.62,-1613 1068.62,-1607 1068.62,-1601 1068.62,-1601 1068.62,-1589 1068.62,-1589 1068.62,-1583 1074.62,-1577 1080.62,-1577 1080.62,-1577 1121.38,-1577 1121.38,-1577 1127.38,-1577 1133.38,-1583 1133.38,-1589 1133.38,-1589 1133.38,-1601 1133.38,-1601 1133.38,-1607 1127.38,-1613 1121.38,-1613"/>
<text text-anchor="middle" x="1101" y="-1589.58" font-family="Arial" font-size="14.00">Process</text>
</g>
<!-- leg_decision -->
<g id="node25" class="node">
<title>leg_decision</title>
<path fill="orange" stroke="black" d="M975.45,-1609.74C975.45,-1609.74 934.8,-1598.26 934.8,-1598.26 929.03,-1596.63 929.03,-1593.37 934.8,-1591.74 934.8,-1591.74 975.45,-1580.26 975.45,-1580.26 981.23,-1578.63 992.77,-1578.63 998.55,-1580.26 998.55,-1580.26 1039.2,-1591.74 1039.2,-1591.74 1044.97,-1593.37 1044.97,-1596.63 1039.2,-1598.26 1039.2,-1598.26 998.55,-1609.74 998.55,-1609.74 992.77,-1611.37 981.23,-1611.37 975.45,-1609.74"/>
<text text-anchor="middle" x="987" y="-1589.58" font-family="Arial" font-size="14.00">Decision</text>
</g>
<!-- leg_data -->
<g id="node26" class="node">
<title>leg_data</title>
<path fill="wheat" stroke="black" d="M893,-1613C893,-1613 863,-1613 863,-1613 857,-1613 851,-1607 851,-1601 851,-1601 851,-1589 851,-1589 851,-1583 857,-1577 863,-1577 863,-1577 893,-1577 893,-1577 899,-1577 905,-1583 905,-1589 905,-1589 905,-1601 905,-1601 905,-1607 899,-1613 893,-1613"/>
<text text-anchor="middle" x="878" y="-1589.58" font-family="Arial" font-size="14.00">Data</text>
</g>
<!-- leg_output -->
<g id="node27" class="node">
<title>leg_output</title>
<path fill="plum" stroke="black" d="M820.62,-1613C820.62,-1613 787.38,-1613 787.38,-1613 781.38,-1613 775.38,-1607 775.38,-1601 775.38,-1601 775.38,-1589 775.38,-1589 775.38,-1583 781.38,-1577 787.38,-1577 787.38,-1577 820.62,-1577 820.62,-1577 826.62,-1577 832.62,-1583 832.62,-1589 832.62,-1589 832.62,-1601 832.62,-1601 832.62,-1607 826.62,-1613 820.62,-1613"/>
<text text-anchor="middle" x="804" y="-1589.58" font-family="Arial" font-size="14.00">Output</text>
</g>
</g>
</svg>
